package edu.psu.sagnik.research.inkscapesvgprocessing.pathparser.impl

import edu.psu.sagnik.research.inkscapesvgprocessing.pathparser.model._

import scala.util.parsing.combinator.RegexParsers
import scala.language.implicitConversions
/**
 * Created by sagnik on 11/12/15.
 * ? => opt
 * * => rep
 * */

class SVGPathParser extends RegexParsers {

  var test=0

  override def skipWhitespace = false

  def wsp: Parser[String]= "\\s|\\n".r ^^ {_.toString} //TODO: this needs to be changed to accomodate #x20, #xD, #xA, #x9
  //see http://www.xmlplease.com/normalized for an example.

  def digit:Parser[String]="""0|1|2|3|4|5|6|7|8|9""".r ^^ {_.toString}

  //def digit_sequence: Parser[String]=digit~rep(digit) ^^{case d~ds => if (ds.isEmpty) d else  d+ds.mkString("")} // digit~digit_sequence ^^{case d~ds => println(s"digit ${d} digit sequence: ${ds}"); ds.toString}|digit^^{_.toString} //

  def number_sequence: Parser[List[String]]=
  digit~number_sequence^^{
    case d~ds=> if (ds.isEmpty) List(d) else d::ds
  } |
  digit^^{List(_)}

  def digit_sequence:Parser[String]=number_sequence^^{_.mkString("")}
  /*this is for testing*/
  /*
      def number_sequence:Parser[Seq[String]]=digit_sequence~opt(comma_wsp)~number_sequence^^
        {
        case n~cw~ns=>if (ns.isEmpty) List(n) else ns:+n
        }|
        digit_sequence^^{List(_)}
  */

  def sign:Parser[String]="""\+|\-""".r ^^{_.toString}

  def exponent:Parser[Double]="""e|E""".r~opt(sign)~digit_sequence ^^ { //TODO: Not handling cases such as e!234, which are definitely wrong
    case ep~Some(sign)~digitSeq =>
      if ("-".equals(sign)) scala.math.exp(-1*digitSeq.toDouble) else scala.math.exp(digitSeq.toDouble)
    case _ => 1d
  }

  def fractional_constant:Parser[String]=
    opt(digit_sequence)~"""\.""".r~digit_sequence ^^{
      case Some(ds1)~dot~ds2 => ds1+"."+ds2
      case None~dot~ds2=> ds2
      case _ => ""
    } |
      digit_sequence~"""\.""".r  ^^{
        case ds~dot=>ds.toString
        case _ => ""
      }

  def floating_point_constant: Parser[String]=
    fractional_constant~opt(exponent)^^{
      case fc~Some(ep)=>(fc.toDouble*ep).toString
      case fc~None=>fc
    } |
      digit_sequence~exponent ^^{
        case ds~ep=>(ds.toDouble*ep).toString
      }

  def integer_constant:Parser[String]= digit_sequence^^{_.toString}

  def comma: Parser[String] = """,""".r ^^ {_.toString}

  def comma_wsp: Parser[String] = wsp~rep(wsp)~opt(comma)~rep(wsp)^^ { _.toString} | comma~rep(wsp)^^{_.toString}

  def flag:Parser[Double] = """0|1""".r ^^{_.toDouble}

  def number:Parser[Double]=
    opt(sign)~floating_point_constant^^{
      case Some(s)~fc => if ("-".equals(s)) ("-"+fc).toDouble else fc.toDouble
      case None~fc => fc.toDouble
    } |
      opt(sign)~integer_constant^^{
        case Some(s)~ic => if ("-".equals(s)) ("-"+ic).toDouble else ic.toDouble
        case None~ic => {ic.toDouble}
      }

  def nonnegative_number:Parser[Double]=
    floating_point_constant^^{_.toDouble}|integer_constant^^{_.toDouble}

  def coordinate:Parser[Double] = number ^^{ _.toDouble}

  def coordinate_pair:Parser[CordPair]=coordinate~opt(comma_wsp)~coordinate^^{
    case cr1~cm~cr2=> CordPair(cr1,cr2)
  }

  implicit def D2B(d:Double):Boolean=if (d==1.0) true else false

  def elliptical_arc_argument:Parser[EllipsePath]=
    nonnegative_number~opt(comma_wsp)~nonnegative_number~opt(comma_wsp)~
      number~(comma_wsp)~flag~opt(comma_wsp)~flag~opt(comma_wsp)~(coordinate_pair)^^{
      case rx~cw1~ry~cw2~rot~cw3~laf~cw4~sf~comma_wsp~cp=>
        EllipsePath(rx,ry,rot,laf,sf,cp)
    }

  def elliptical_arc_argument_sequence:Parser[Seq[EllipsePath]]=
    elliptical_arc_argument~opt(comma_wsp)~elliptical_arc_argument_sequence ^^{
      case ea~cw1~eas=>if (eas.isEmpty) List(ea) else ea+:eas
    } |
      elliptical_arc_argument^^{List(_)}

    def elliptical_arc: Parser[EllipseCommand]="""A|a""".r~rep(wsp)~elliptical_arc_argument_sequence^^{
      case c~ws~paths=> if ("a".equals("c")) EllipseCommand(false,paths) else EllipseCommand(true,paths)
    }

  def smooth_quadratic_bezier_curveto_argument_sequence:Parser[Seq[SmQBCPath]]=
    coordinate_pair~opt(comma_wsp)~smooth_quadratic_bezier_curveto_argument_sequence^^{
      case cp~cw~cps=>if (cps.isEmpty) List(SmQBCPath(cp)) else SmQBCPath(cp)+:cps
    }

  def smooth_quadratic_bezier_curveto:Parser[SmQBC]=
    """T|t""".r~rep(wsp)~smooth_quadratic_bezier_curveto_argument_sequence^^{
      case c~cw~argseq=>if ("c".equals(c)) SmQBC(false,argseq) else SmQBC(true,argseq)
    }

  def quadratic_bezier_curveto_argument: Parser[QBCPath]=
    coordinate_pair~opt(comma_wsp)~coordinate_pair^^{case cp1~cws~cp2=>QBCPath(cp1,cp2)}

  def quadratic_bezier_curveto_argument_sequence:Parser[Seq[QBCPath]]=
    quadratic_bezier_curveto_argument~opt(comma_wsp)~quadratic_bezier_curveto_argument_sequence^^{
      case qc~cws~qcs=> if (qcs.isEmpty) List(qc) else qc+:qcs
    } |
      quadratic_bezier_curveto_argument^^{List(_)}

  def quadratic_bezier_curveto:Parser[QBC]=
    """Q|q""".r~rep(wsp)~quadratic_bezier_curveto_argument_sequence^^{
      case c~cw~argseq=>if ("q".equals(c)) QBC(false,argseq) else QBC(true,argseq)
    }

  def smooth_curveto_argument: Parser[SMCPath]=
    coordinate_pair~opt(comma_wsp)~coordinate_pair^^{case cp1~cws~cp2=>SMCPath(cp1,cp2)}

  def smooth_curveto_argument_sequence:Parser[Seq[SMCPath]]=
    smooth_curveto_argument~opt(comma_wsp)~smooth_curveto_argument_sequence^^{
      case qc~cws~qcs=> if (qcs.isEmpty) List(qc) else qc+:qcs
    } |
      smooth_curveto_argument^^{List(_)}

  def  smooth_curveto:Parser[SMC]=
    """S|s""".r~rep(wsp)~smooth_curveto_argument_sequence^^{
      case c~cw~argseq=>if ("s".equals(c)) SMC(false,argseq) else SMC(true,argseq)
    }

  def curveto_argument:Parser[CurvePath]=
    coordinate_pair~opt(comma_wsp)~coordinate_pair~opt(comma_wsp)~coordinate_pair^^{case cw1~cws1~cw2~cws2~cw3 => CurvePath(cw1,cw2,cw3)}

  def curveto_argument_sequence:Parser[Seq[CurvePath]]=
    curveto_argument~opt(comma_wsp)~curveto_argument_sequence^^{
      case qc~cws~qcs=> if (qcs.isEmpty) List(qc) else qc+:qcs
    } |
      curveto_argument^^{List(_)}


  def curveto:Parser[Curve]=
    """C|c""".r~rep(wsp)~curveto_argument_sequence^^{
      case c~cw~argseq=>if ("c".equals(c)) Curve(false,argseq) else Curve(true,argseq)
    }

  def  vertical_lineto_argument_sequence:Parser[Seq[VLPath]]=
    coordinate~opt(comma_wsp)~vertical_lineto_argument_sequence^^{
      case c~cws~cs=> if (cs.isEmpty) List(VLPath(c)) else VLPath(c)+:cs
    } |
      coordinate^^{a=> List(VLPath(a))}

  def vertical_lineto:Parser[VL]=
    """V|v""".r~rep(wsp)~vertical_lineto_argument_sequence^^{
      case c~cw~argseq=>if ("v".equals(c)) VL(false,argseq) else VL(true,argseq)
    }

  def  horizontal_lineto_argument_sequence:Parser[Seq[HLPath]]=
    coordinate~opt(comma_wsp)~horizontal_lineto_argument_sequence^^{
      case c~cws~cs=> if (cs.isEmpty) List(HLPath(c)) else HLPath(c)+:cs
    } |
      coordinate^^{a=>List(HLPath(a))}

  def horizontal_lineto:Parser[HL]=
    """H|h""".r~rep(wsp)~horizontal_lineto_argument_sequence^^{
      case c~cw~argseq=>if ("h".equals(c)) HL(false,argseq) else HL(true,argseq)
    }

  def lineto_argument_sequence:Parser[Seq[LinePath]]=
    coordinate_pair~opt(comma_wsp)~lineto_argument_sequence^^{
      case qc~cws~qcs=> if (qcs.isEmpty) List(LinePath(qc)) else LinePath(qc)+:qcs
    } |
      coordinate_pair^^{a=>List(LinePath(a))}

  def lineto:Parser[Line]=
    """L|l""".r~rep(wsp)~lineto_argument_sequence^^{
      case c~cw~argseq=>if ("l".equals(c)) Line(false,argseq) else Line(true,argseq)
    }

  def closepath:Parser[Close]="""Z|z""".r^^{case _ => Close(true,Seq.empty[Any])}

  def moveto_argument_sequence:Parser[Seq[MovePath]]=
    coordinate_pair~opt(comma_wsp)~moveto_argument_sequence^^{
      case qc~cws~qcs=> if (qcs.isEmpty) List(MovePath(qc)) else MovePath(qc)+:qcs
    } |
      coordinate_pair^^{a=>List(MovePath(a))}

  def moveto:Parser[Move]=
    """M|m""".r~rep(wsp)~moveto_argument_sequence^^{
      case c~cw~argseq=>if ("m".equals(c)) Move(false,argseq) else Move(true,argseq)
    }

  def drawto_command:Parser[PathCommand]=
    closepath^^{a=>a}|
      lineto^^{a=>a} |
      horizontal_lineto^^{a=>a} |
      vertical_lineto^^{a=>a} |
      curveto^^{a=>a} |
      smooth_curveto^^{a=>a} |
      quadratic_bezier_curveto^^{a=>a}|
      smooth_quadratic_bezier_curveto^^{a=>a}|
      elliptical_arc^^{a=>a}

  def drawto_commands:Parser[Seq[PathCommand]]=
    drawto_command~rep(wsp)~drawto_commands^^{
      case dc~ws~dcs => if (dcs.isEmpty) List(dc) else dc+:dcs
    } | drawto_command^^{a=>List(a)}

  def moveto_drawto_command_group:Parser[Seq[PathCommand]]=
    moveto~rep(wsp)~opt(drawto_commands)^^{
      case mt~ws~Some(dt)=>mt+:dt
      case mt~ws~None => List(mt)
    }


  def moveto_drawto_command_groups:Parser[Seq[PathCommand]]=
    moveto_drawto_command_group~rep(wsp)~rep(moveto_drawto_command_group)^^{
      case mdcg~ws~mdcgs => if (mdcgs.isEmpty) mdcg else mdcg ++ mdcgs.flatten
    }|
      moveto_drawto_command_group^^{case a=>a}

  def svg_path:Parser[Seq[PathCommand]]=
    rep(wsp)~opt(moveto_drawto_command_groups)~rep(wsp)^^{
      case ws~Some(mdcgs)~wsp => mdcgs
      case ws~None~wsp => Seq.empty[PathCommand]
    }
}

object TestSVGPathParser extends SVGPathParser{
  def main(args: Array[String]) = {
    val c="m 3964.54,3342.8 251.35,0 m -251.35,17.43 0,-34.86 m 251.35,34.86 0,-34.86 m -1742.01,88.84 264.28,637.09 528.57,5.62 528.56,-301.39 264.28,-66.92 m -1585.69,-324.44 0,99.52 m -17.43,-99.52 34.86,0 m -34.86,99.52 34.86,0 m 246.85,498.2 0,178.25 m -17.43,-178.25 34.86,0 m -34.86,178.25 34.86,0 m 511.14,-149.57 0,132.7 m -17.43,-132.7 34.86,0 m -34.86,132.7 34.86,0 m 511.13,-414.41 0,93.9 m -17.43,-93.9 34.86,0 m -34.86,93.9 34.86,0 m 246.85,-144.51 0,60.17 m -17.43,-60.17 34.86,0 m -34.86,60.17 34.86,0 z"
    //val c="m 3964.54,3342.8 l -1742.01,88.84 264.28,637.09 528.57,5.62 528.56,-301.39 264.28,-66.92"
    //val c="M10 10 C 20 20, 40 20, 50 10 70 20, 120 20, 120 10 120 20, 180 20, 170 10"
    //parse(digit_sequence, "12345") match {
    //  parse(wsp, " ") match {
    //    parse(coordinate_pair, "12    20") match {
    //val c="M 5,5 L 5,15 L 15,15 L 15,5 z L 20,20"
    //val c="m 2650.67,2755.92 2.15,-4.16 -0.67,-14.8 -1.32,-1.48 -14.33,-13.44 -0.36,-0.47 -8.89,-14.41 -5.72,-14.81 -0.02,-0.04 0.02,-0.03 0.18,0.03 14.63,1.98 14.77,5.38 14.78,4.76 8.76,3.11 6,2.68 14.74,8.76 11.93,3.67 2.83,0.8 14.81,-0.23 14.78,2.98 5.75,-3.15 9.2,-9.86 10.31,-4.73 4.61,-3.54 3.06,-11.19 5.23,-14.77 4.79,-14.78 2.33,-7.06 2.94,-7.72 -2.8,-3.42 -9.01,-11.58 -5.55,-13.18 -1.18,-1.76 -8.48,-14.96 -4.9,-10.84 -1.44,-4.11 1.52,-3.09 14.88,-0.12 1.44,3.41 10.8,15.01 2.4,1.83 5.37,-1.74 9.6,-6.32 13.7,-8.26 1.3,-1.29 10.71,-13.44 4.43,-5.86 10.37,6.06 4.43,0.96 14.74,10.46 3.72,3.79 10.94,11.16 8.56,4.02 6.19,4.24 14.9,-1.11 11.09,-2.62 3.87,-2.16 11.13,-12.48 4.11,-8.35 1.41,-6.45 -0.21,-14.91 -0.82,-1.13 -9.34,-13.94 -3.72,-14.98 -0.62,-14.93 1.14,-14.91 13.73,-12.95 14.91,2.03 14.82,6.66 9.01,5.15 5.78,3.11 3.04,-2.95 12.09,-7.48 3.94,-7.17 11.33,-10.05 14.94,0.91 14.92,1.34 14.9,2.91 4.36,6.06 2.59,15 2.59,15 -0.09,14.93 4.13,14.61 0.11,0.41 -0.14,1.06 -0.99,13.84 0.66,1.7 14.8,5.69 14.81,4.7 14.88,1.67 14.98,-2.59 4.74,-9.73 -4.41,-4.82 -4.74,-10.32 -4.8,-15.05 -4.48,-14.97 -0.03,-0.07 -9.42,-15.15 -4.99,-7.75 -9.95,-7.53 -4.77,-3.61 -14.86,-4.41 -8.82,-7.53 -5.88,-5.25 -8.38,-10 -6.27,-5.49 -14.93,-2.24 -7.8,-7.79 -6.91,-5.78 -5.09,-9.42 -6.78,-15.1 -2.46,-10.88 -3.01,-4.2 -5.07,-15.08 8.54,-6.55 14.99,0.57 15.07,-3.68 14.9,5.08 14.92,4.16 1.74,1.73 12.99,11.67 14.96,1.77 15.06,-2.96 12.45,-9.34 2.82,-3.12 10.62,-11.6 4.97,-14.87 14.87,6.8 7.66,-6.34 -3.5,-15.11 11.58,-10.58 6.32,10.99 8.18,12.34 1.29,2.9 4.59,15.13 -5.26,14.89 -1.42,1.64 -15.19,7.73 -13.26,4.95 -1.87,0.66 -13.69,13.99 1.34,15.02 11.4,12.84 1.87,2.45 12.8,11.39 4.22,3.98 10.41,10.49 3.58,4.82 5.94,15.11 4.53,15.07 0.07,0.08 14.91,1.66 6.08,-1.21 8.97,-2.23 15.03,-2.37 15.12,-5.73 10.63,-3.35 4.5,-2.49 6.53,2.79 8.17,7.38 4.47,7.93 5.79,15.13 3.86,7.43 8.65,7.88 5.93,5.64 5.16,9.64 -2.75,14.87 -2.91,14.85 7.2,15.15 5.37,15.09 0.79,1.73 11.55,13.56 2.86,3.7 14.98,-1.86 0.75,-1.27 4.77,-14.78 2.02,-14.88 0.9,-14.91 0.1,-14.95 2.17,-14.89 6.8,-8.49 3.56,-6.16 6.3,-14.78 6.03,-8.79 5.4,-5.84 9.98,-7.1 14.78,6.62 1.27,1.29 13.08,15.4 0.1,0.19 14.84,4.31 14.94,1.56 14.76,6.63 15.02,-1.02 2.53,-9.62 2.93,-14.9 3.81,-14.87 -7.61,-9.6 -6.02,-5.87 -6.62,-15.23 0.21,-15.01 -1.33,-1.86 -13.85,-13.66 -0.71,-0.79 -11.39,-14.63 -3,-5.43 -4.2,-9.83 0.08,-15.04 0.64,-15.03 -4.75,-15.2 -4.82,-9.23 -3.34,-6.08 -11.15,-12.96 -6.71,-2.64 6.46,-14.88 0.86,-2.97 5.48,-11.91 -4.79,-11.29 -0.82,-3.96 -1.11,-15.13 -4.05,-15.21 0.55,-15.08 0.06,-15.11 7.49,-7.45 15.31,-6.76 1.76,-0.19 13.48,-3.53 7.81,-10.96 7.11,-14.92 1.06,-2.58 15.4,-8.68 15.04,3.31 12.84,9.31 1.97,1.62 14.99,4.6 5.2,-5.52 7.34,-14.91 3.63,-11.44 1.51,-3.56 -1.15,-7.94 -1.11,-7.29 -8.86,-15.44 -4.35,-3.9 -10.04,-11.72 -4.59,-5.74 -11.7,-9.94 -3.09,-2.81 -14.92,-8.78 -14.9,-4.57 8.36,-14.93 7.34,-7.47 12.35,-7.14 3.35,-9.95 11.15,10.38 3.73,0.48 15.11,2.65 14.95,8.22 6.98,5.1 7.84,6.71 11.4,9.1 3.44,2.07 15.09,3 15.07,3.9 15.31,-3.5 15.01,5.59 5.54,-8.77 2.84,-15.11 2.62,-15.12 1.27,-15.18 2.28,-15.15 3.2,-6.04 15.44,-6.19 1.49,-2.32 3.02,-15.13 -3.54,-11.29 -1.77,-4.14 -6.42,-15.46 -5.93,-14.23 -1.12,-1.26 -12.42,-15.66 -1.11,-1.43 -10.01,-14.19 -4.7,-3.13 -4.95,-12.45 -9.45,-14.95 -0.32,-0.63 -7.26,-15.5 -6.83,-11.77 -2.18,-3.79 -9.28,-15.57 -3.08,-4.83 -5.26,-10.71 -9.26,-15.08 -0.29,-0.5 -10.21,-15.6 -4.15,-5.85 -8.06,-9.81 -6.63,-11.65 -2.53,-3.92 -3.68,-15.42 -0.22,-15.32 3.77,-15.22 4.35,-9.35 2.75,-5.78 7.09,-15.14 6.41,-11.16 4.59,-3.87 11.1,-8.11 15.41,-1.96 15.27,3.09 15.19,5.33 15.25,3.4 15.48,-3.9 15.56,-6.51 15.25,3.47 15.13,7.38 7.55,2.09 7.67,2.59 15.38,-0.65 2.07,-1.13 13.56,-7.07 6.1,-7.66 9.76,-7.04 15.62,-7.26 0.64,-0.21 14.95,-5.83 15.58,-5.74 15.45,-1.71 15.34,1.53 15.24,4.43 15.2,5.6 15.24,4.36 15.4,-0.24 15.57,-4.62 15.64,-6.38 4.14,-1.26 11.42,-2.91 15.45,-1.08 15.36,1.58 15.34,1.94 15.54,-3.3 9.26,-8.53 6.83,-8.84 7.54,-6.03 8.39,-6.69 15.64,-5.33 9.73,-2.1 5.83,-0.8 15.38,1.58 0.58,0.08 14.77,2.21 7.79,-1.3 7.77,-1.59 15.59,-3.52 15.41,1.15 15.41,1.1 15.32,3.32 6.99,2.69 8.22,3.05 15.13,7.89 11.63,6 3.49,1.75 15.07,8.92 12.4,6.13 2.73,1.37 15.11,7.9 7.39,7.3 7.44,6.98 15.32,2.95 15.32,3.12 15.31,3.1 0.63,-13.72 0.7,-15.43 0.7,-15.44 0.7,-15.45 0.7,-15.45 0.69,-15.45 0.7,-15.47 0.69,-15.46 0.69,-15.47 0.69,-15.48 0.68,-15.48 0.69,-15.49 0.68,-15.49 0.68,-15.49 0.67,-15.5 0.68,-15.51 0.68,-15.51 0.67,-15.52 0.67,-15.52 0.67,-15.53 0.67,-15.53 0.66,-15.53 0.67,-15.54 0.66,-15.55 0.66,-15.55 0.66,-15.56 0.66,-15.56 0.65,-15.56 0.65,-15.57 0.66,-15.58 0.65,-15.58 0.65,-15.58 0.64,-15.59 0.65,-15.6 0.64,-15.6 0.65,-15.6 0.64,-15.61 0.63,-15.61 0.64,-15.62 0.64,-15.62 0.63,-15.63 0.63,-15.64 0.64,-15.632 0.62,-15.645 0.63,-15.644 0.63,-15.653 0.62,-15.656 0.63,-15.66 0.62,-15.668 0.62,-15.668 -15.67,-0.617 -15.67,-0.613 -15.67,-0.61 -15.67,-0.601 -15.67,-0.602 -15.66,-0.59 -15.66,-0.59 -15.67,-0.586 -15.66,-0.578 -15.65,-0.578 -15.66,-0.566 -15.66,-0.567 -15.65,-0.562 -15.66,-0.555 -15.65,-0.551 -15.65,-0.546 -15.65,-0.543 -15.64,-0.536 -15.65,-0.531 -15.65,-0.527 -15.64,-0.524 -15.64,-0.519 -15.64,-0.512 -15.64,-0.508 -15.64,-0.504 -15.64,-0.496 -15.64,-0.496 -15.63,-0.488 -15.64,-0.484 -15.63,-0.481 -15.63,-0.473 -15.63,-0.468 -15.63,-0.465 -15.63,-0.461 -15.62,-0.453 -15.63,-0.449 -15.62,-0.446 -15.63,-0.441 -15.62,-0.434 -15.62,-0.429 -15.62,-0.426 -15.62,-0.418 -15.62,-0.418 -15.61,-0.41 -15.62,-0.407 -15.61,-0.402 -15.62,-0.394 -15.61,-0.387 -15.61,-0.387 -15.61,-0.383 -15.61,-0.375 -15.61,-0.371 -15.61,-0.367 -15.61,-0.359 -15.6,-0.356 -15.61,-0.351 -15.6,-0.344 -15.6,-0.344 -14.01,-0.301 -1.66,2.961 -9.32,12.414 -6.73,8.579 -12.76,6.609 -2.99,0.707 -3.2,-0.832 -12.11,-13.176 -1.04,-2.695 -8.29,-15.774 -5.9,-0.117 -15.6,-0.312 -15.59,-0.305 -15.6,-0.301 -15.6,-0.297 -13.15,-0.242 -2.48,2.285 -15.76,8.774 -9.49,-11.563 -5.9,-0.105 -15.59,-0.278 -15.59,-0.269 -15.6,-0.266 -15.59,-0.261 -10.81,-0.176 -4.94,9.808 -3.78,5.641 -12.05,9.367 -15.65,4.426 -15.55,-2.406 -11.8,-12.242 -0.3,-15.594 -3.06,-0.047 -15.59,-0.231 -15.58,-0.222 -15.59,-0.219 -15.59,-0.215 -15.58,-0.207 -15.59,-0.203 -15.58,-0.199 -15.58,-0.196 -15.58,-0.187 -15.59,-0.184 -15.58,-0.179 -15.58,-0.172 -15.58,-0.168 -15.58,-0.16 -15.58,-0.16 -15.58,-0.153 -15.58,-0.148 -2.69,-0.024 2.55,15.141 0.09,0.461 9.26,15.66 6.02,5.184 15.5,7.277 15.53,3.441 0.55,0.043 15,1.184 12.21,14.672 3.16,2.89 4.62,-2.804 11.14,-13.992 15.44,10.824 1.21,3.484 -1.26,0.86 -15.71,12.683 -1.06,1.809 -4.47,15.508 2.96,15.582 -2.56,15.515 -0.4,15.535 2.31,15.563 2.2,8.59 4.27,7.01 11.02,13.04 3.36,2.66 7.84,15.61 3.95,12.2 0.98,3.38 -1.09,4.9 -1.27,10.58 -1.4,15.48 -5.16,15.44 -8.28,8.55 -15.53,2.95 -15.41,-7.55 -15.54,4.31 -15.53,4.37 -15.45,-4.12 -15.46,-2.57 -15.47,-1.98 -15.44,-4.74 -15.49,0.2 -15.59,11.42 -2.02,2.9 -8.74,15.41 -4.95,7.44 -15.53,7.63 -14.64,0.11 14.59,5.91 4.24,9.72 -4.33,1.19 -15.47,0.91 -5.42,-2.31 5.5,-15.42 -15.39,-3.32 -15.34,3.09 12.06,15.56 3.1,5.03 6.06,10.5 -6.2,8.92 -1.4,6.48 -4.59,15.42 -1.76,15.43 -0.42,15.44 -7.12,15.38 -0.67,0.71 -10.4,14.64 -5.18,7.74 -6.46,7.61 -9.07,8.99 -9.4,6.3 -6.08,3.62 -15.42,0.53 -3.34,-4.3 -5.27,-15.44 -4.14,-15.45 -2.42,-8.81 -12.7,-6.7 -2.68,-2.81 -3.99,2.78 -11.46,1.55 -6.33,-1.64 -5.68,-15.45 2.58,-15.43 3.93,-15.43 2.37,-15.44 3.48,-11.88 1.13,-3.55 4.72,-15.44 2.4,-15.45 4.46,-15.45 3.02,-4.69 7.65,-10.74 7.94,-11.11 4.09,-4.31 5.81,-15.46 -9.75,-9.98 -1.62,-5.57 -0.62,-15.5 2.39,-7.87 3.25,-7.61 5.89,-15.48 -8.97,-8.27 -8.65,-7.33 -4.18,-15.54 -1.94,-15.541 -0.56,-1.488 -9.45,-14.086 -6,-3.262 -15.5,-8.476 -4.45,-3.911 -2.31,-15.546 -2.61,-15.559 1.65,-15.543 -2.35,-15.566 -5.21,-2.934 -15.53,-8.094 -7.57,-4.633 -7.96,-5.371 -15.55,-6.05 -15.57,0.894 -15.58,3.871 -5.29,6.504 -10.3,6.859 -15.57,6.137 -15.55,-6.027 -5.4,-7.035 -0.68,-15.567 2.05,-15.57 -11.5,-0.008 -15.58,-0.008 -15.57,-0.004 -15.58,0.004 -9.67,0.004 -5.89,13.051 -0.95,2.523 -7,15.575 5.12,15.554 2.85,3.012 15.56,4.195 15.56,6.914 1.11,1.422 -1.11,1.293 -12.86,14.258 -2.69,2.438 -8.13,13.113 -3.96,15.543 -2.43,15.535 -0.99,1.363 -10.73,14.176 -4.79,4.57 -14.1,10.971 -1.4,1.3 -15.51,11.11 -5.92,3.15 -9.57,9.97 -15.51,0.71 -15.5,2.29 -2.8,2.64 -12.68,7.91 -9.52,7.67 -5.95,4.01 -15.47,9.85 -1.92,1.73 -6.29,15.52 -6.32,15.52 0.09,15.49 4.61,15.46 10.11,9.43 15.48,1.05 15.49,4.05 0.86,0.79 9.1,15.45 4.35,15.45 1.26,3.06 6.61,12.38 3.12,15.44 0.56,15.45 2.28,15.44 1.92,15.43 1.18,8.64 0.78,6.79 1.64,15.42 1.31,15.42 1.66,15.41 2.13,15.4 6.69,15.39 1.41,1.94 15.42,12.63 0.93,0.79 12.57,15.37 1.93,2.99 12.22,12.38 1.94,15.38 -7.83,15.38 -6.25,10.08 -15.36,5 -0.09,0.33 -1.97,15.36 -0.67,15.36 2.81,10.85 0.94,4.5 6.26,15.33 6.03,15.33 2.18,8.38 2.56,6.95 12.8,12.76 15.33,1.52 1.17,1.02 14.16,12.77 15.32,-2.13 15.32,0.91 5.1,3.76 10.21,11.03 4.36,4.3 10.94,8.88 6.71,6.45 8.57,13.81 1.3,1.51 13.97,13.32 15.3,0.88 15.3,-2.39 5.86,3.6 9.39,12.1 3.82,3.24 11.43,7.74 15.27,4.58 15.33,-9.56 15.3,-2.42 0.15,-0.12 15.21,-13.49 15.29,2.64 15.31,-3.84 0.52,-0.36 14.81,-4.35 13.25,-10.77 2.13,-1.24 15.35,-5.93 12.08,-7.94 3.29,-1.05 1.29,1.09 13.93,11.84 4.88,3.61 10.33,7.81 13.41,7.69 1.79,4.45 6.27,10.92 8.89,4.55 15.23,7.1 5.03,3.91 10.18,4.82 15.27,1.25 15.3,-0.84 15.29,-0.18 15.35,-4.17 1.47,-0.12 13.83,-0.87 15.29,0.46 15.29,0.13 4.92,0.87 10.33,2.87 15.24,4.5 15.26,2.33 15.28,1.37 15.41,-7.92 15.28,1.27 12.41,-3.04 2.96,-1.46 15.34,-2.78 7.83,4.65 7.35,3.36 15.23,4.33 13.33,8.2 1.82,0.77 0.88,-0.73 14.65,-12.5 5.41,-2.46 10.04,-5.76 15.45,-7.94 1.24,-1.14 12.21,-15.1 2.22,-3.39 7.71,-11.75 3.5,-15.27 4.22,-15.25 0.74,-3.72 2.18,-11.57 2.56,-15.3 7.88,-15.21 3.6,-4.9 4.86,-10.31 10.98,-14.89 0.25,-0.26 14.76,-15.1 0.67,-0.79 10.92,-14.36 4.84,-5.5 11.1,-9.58 -1.19,-15.42 6.14,-8.68 11.06,-6.38 4.52,-2.67 15.39,0.82 9.69,-12.96 6.05,-3.22 15.42,-0.52 6.06,4.32 9.2,3.03 15.28,6.15 5.75,6.88 -3.9,15.32 8.06,15.58 1.2,15.42 -0.31,15.38 -0.4,15.38 -1.95,15.33 0.05,15.38 -11.24,9.49 -13.81,5.31 -1.91,15.32 -0.17,3.2 -1.03,12.13 -5.77,15.22 -8.03,15.16 -1.54,4.06 -3.72,11.16 -6.93,15.18 -1.34,15.3 -4.43,8.55 -4.31,6.57 -11.39,11.01 -2.46,4 -0.63,15.3 0.07,15.29 -6.26,15.16 -6.26,15.15 3.85,15.37 5.75,15.4 3.71,7.16 8.75,8.38 6.11,9.7 5.26,5.82 8.52,15.45 0.84,7.02 1.14,8.28 5.28,15.37 7.93,14.63 0.35,0.81 10.97,15.5 3.38,6.3 4.76,9.13 6.81,15.39 2.77,11.49 1.4,3.84 10.69,15.48 2.5,5.89 5.27,9.52 3.9,15.31 5.19,8.07 7.4,7.46 7.4,7.84 8.9,7.78 -3.42,15.1 0.17,15.19 -6.98,11.96 -3.78,2.93 3.59,4.3 8.99,11.21 5.68,7.4 3.13,8.01 3.54,15.26 1.3,15.19 5.99,4.89 9.16,10.69 -2.69,15.07 0.92,15.17 -8.89,12.06 -0.87,2.79 -13.37,14.75 -1.41,1.18 -15.34,7.95 -9.3,5.26 -6.19,8.3 -2.6,6.56 -4,15 -3.44,14.99 -3.42,15 -3.15,4 -9.11,10.74 -3.87,14.97 -2.96,5.76 -15.06,-0.23 -12.57,-6.35 1.64,-15.03 -3.28,-11.05 -15.09,0.68 -8.31,9.68 -7.21,8.03 -6.11,6.7 -7.61,14.87 -1.94,2.29 -15.18,5.27 -4.99,6.94 -10.52,11.91 -4.38,2.76 -10.84,5.01 -4.04,-5.36 -10.58,-12.08 -1.65,-3.25 -8.06,-15.23 -4.67,-10.68 -2.14,-4.52 -5.6,-15.18 -6.59,-12.31 -2.71,-2.96 -9.4,-15.27 -2.43,-6.01 -4.3,-9.21 -10.32,-12.3 -3.71,-3.08 -11.12,-9.1 -14.99,-4.61 -4.49,-1.99 -10.39,-8.08 -6.36,-7.34 -8.33,-13.44 -3.26,-1.87 -11.77,-1.6 -4.75,1.29 -9.08,14.92 -1.6,2.08 -11.3,12.77 2.46,15.12 8.16,9.63 8.09,5.74 6.67,10.67 3.65,4.59 11.21,5.7 15.06,-0.24 10.07,10.31 -10.52,12.27 -1.93,2.54 1.65,11.6 1.59,3.51 -1.67,0.48 -15.23,9.84 -2.33,4.33 -4.9,14.94 -4.7,14.93 -3.81,2.04 -15.03,0.55 -15,-0.86 -8.36,-2.53 -6.5,-6.33 -15,-0.78 -14.15,6.48 -0.99,0.31 -15.07,3.3 -15.07,3.57 -12.6,7.11 -2.54,1.88 -15.08,4.84 -9.37,7.86 -5.87,8.04 -13.23,6.66 -2.03,11.61 -14.97,-0.81 -14.99,1.08 -14.93,-4.14 -11.95,-8.54 -2.9,-0.9 -1.8,0.84 -12.45,14.82 -0.95,1.35 -6.61,13.53 -8.67,12.34 -3.33,2.48 -11.72,5.83 -7.92,8.9 4.32,15 -2.64,14.91 -9.26,10.05 -5.08,4.72 -4.73,14.87 -3.08,14.89 -2.49,6.58 -5.69,-6.67 -6.41,-14.98 -2.55,-3.05 -7.62,-11.98 -7.1,-9.34 -6.08,-5.72 -8.68,-13.15 -15.04,11.99 -0.42,0.94 -14.6,9.59 -13.65,5.1 -1.33,1.38 -7.94,13.48 -7.16,10.11 -7.26,4.69 5.18,14.95 1.9,4.49 6.88,10.47 7.87,9.7 7.64,5.32 -0.53,14.88 -0.1,14.88 2.27,14.89 5.15,3.5 14.85,1.57 14.21,-4.77 0.71,-0.16 0.38,0.17 14.39,9.69 2.47,5.35 1.37,14.87 -1.81,14.83 -2.47,7.51 -3.29,7.27 -6.93,14.77 -4.87,3.4 -14.85,2.27 -14.84,2.12 -14.77,-6.72 -4.76,-1.56 -10,-7.96 -14.81,-2.9 -14.81,-2.5 -14.84,1.31 -14.89,8.61 -4.39,2.94 -10.47,4.99 -5.78,-5.08 -9,-5.74 -11.91,-9.18 -2.86,-4.43 -7.39,-10.45 -7.37,-10.94 -14.61,-3.98 -0.22,-0.05 -14.84,-3.63 -14.85,-0.01 -14.85,-0.32 -14.84,-6.5 -3.15,-4.46 -11.63,-14.87 -0.06,-0.09 -6.75,-14.78 -8.11,-11.94 -5.42,-2.93 -9.46,-4.16 -14.88,2.05 -4.32,2.13 -10.54,5.7 -14.88,-1.06 -12.55,-4.58 -2.34,-1.58 -14.88,0.21 -7.37,1.44 -7.49,3.27 -14.83,9.96 -14.93,-13.07 -0.12,-0.01 -14.77,-1.14 -14.89,-2.5 -14.93,-7.47 -7.97,-3.49 -6.97,-5.12 -12.41,-9.64 -2.56,-2.68 -14.99,-12.04 -0.07,-0.06 -12.82,-14.81 -2.14,-1.52 -14.97,-7.29 -14.96,-4.66 -14.89,3.57 -9.64,10.4 -5.14,3.11 -14.82,9.61 -7.35,2.46 -7.49,3.38 -10.19,-3.19 -4.78,-2.42 -10.07,-12.32 -3.27,-14.88 -1.04,-14.92 -1.08,-4.92 -2.47,4.97 -6.44,15 -5.75,3.18 -14.82,8.09 -6.84,3.99 -7.98,3.53 -14.85,4.46 -14.88,2.77 -3.66,4.73 -10.39,15.06 -0.56,0.79 -3.9,14.18 -10.63,10.56 -6.94,4.61 -7.79,5.9 -14.91,-0.96 -6.18,-4.48 -8.78,-14.75 -0.27,-0.46 -0.45,0.47 -14.3,8.61 -4.61,6.62 -10,9.71 -4.23,5.44 0.5,14.88 -8,15.03 -2.48,1.6 -14.76,6.41 -14.88,-0.21 -14.98,-4.89 -14.91,-1.45 -14.8,4.18 -7.37,-3.97 -7.75,-6.79 -13.12,-7.65 -1.96,-1.1 -14.9,0.15 -14.91,-0.27 -14.86,1.74 -1.65,0.58 -13.05,7.81 -14.76,5.72 -3.19,2.11 -7.09,15.07 -4.14,2.15 -14.73,6.47 -14.82,2.87 -14.66,4.65 -0.1,0.02 -14.81,3.17 -7.7,-2.58 -7.39,-4.51 -6.74,-10 -4.09,-14.79 0.62,-14.94 -1.32,-14.88 1.03,-14.96 4.91,-15.07 3.16,-4.58 14.75,-7.42 14.93,-0.36 14.9,-1.25 14.88,-2.38 9.1,-0.79 5.76,-2.38 3.11,2.16 11.94,2.7 11.73,11.66 3.54,2.55 15.13,8.97 11.06,2.71 3.94,1.05 13.61,-1.45 1.27,-0.13 14.83,-4.14 8.85,-11.19 -5.64,-14.8 -3.9,-5.56 -15.05,-5.65 -3.55,-3.23 -11.71,-11.45 -3.53,-3.15 -11.71,-9.94 -6.39,-4.6 -8.79,-5.06 -15.03,-2.92 -15.06,-4.19 -1.64,-1.83 -13.54,-7.15 -14.95,0.94 -14.89,3.08 -14.99,-0.86 -14.9,3.07 -5.66,2.91 -9.13,4.02 -14.79,6.66 -6.75,5.12 -7.86,7.8 -6.05,7.56 -8.32,13.62 -1.25,1.61 -12.37,15.32 -0.83,0.75 -2.59,-0.65 -12.61,-7.66 -5.03,-6.79 -10.33,-6.69 -14.96,0.31 -14.89,2.84 -14.84,4.24 -2.72,1.06 -1.89,15.03 5.42,9.65 1.98,5.08 -1.72,3.4 -14.68,8.4 -14.91,1.49 -11.65,3.05 -3.18,0.84 -14.73,6.98 -11.79,8.14 -2.82,1.99 -14.66,8.64 -3.58,5.05 -10.67,14.94 -0.33,0.39 -10.54,15.32 -3.18,9.34 -2.13,5.79 -12.27,9.03 -15.19,-6.94 -1.23,-1.04 -9.95,-14.57 -4.52,-4.45 -7.37,-10.06 -6.11,-14.74 -2.53,-3.28 -6.89,-11.34 -8.75,-6.56 -14.85,3.64 -7.58,4.11 -6.94,7.7 -14.74,6.15 -3.8,-12.87 -2.7,-14.88 -3.39,-14.86 -3.82,-14.85 -3.96,-10.96 -1.81,-3.83 -12.29,-14.54 -1.95,-8.18 -2.38,-6.67 -2.06,-14.96 -1,-15 0.29,-15.05 2.67,-12.14 1.09,-3.06 4.48,-15.23 6.08,-15.29 2.03,-2.82 5.85,2.52 9.52,5.71 5.61,8.79 7.7,14.76 2.97,9.4 1.93,5.46 1.88,14.97 12.42,11.68 10.69,-12.53 3.04,-15.15 -5.1,-14.85 4.52,-8.95 1.63,-6.32 4.76,-15.22 1.64,-15.11 1.04,-15.1 1.22,-15.12 -0.15,-15.07 -2.01,-15.01 -1.52,-15.03 0.63,-15.12 0.88,-15.13 -3.02,-15 -10.93,-7.48 -9.17,8.18 -2.02,15.18 -2.98,3.51 -14.8,8.6 -15.09,0.44 -7.16,-11.12 1.77,-15.18 0.53,-15.14 -12.21,-12.34 -2.44,-2.27 -9.49,-14.79 -0.37,-15.13 1.31,-15.2 -0.78,-15.12 -3.49,-15.04 -2.86,-5.27 -5.15,-9.61 -8.31,-14.88 -2.8,-5.65 -4.41,-9.27 -4.73,-15.02 -1.54,-15.14 8.84,-12.11 15.08,-3.51 0.48,-0.45 -0.25,-15.19 -1.26,-15.17 -0.11,-1.88 -0.74,-13.31 -2.49,-15.13 -1.37,-15.18 2.01,-15.31 0.5,-1.63 4.87,-13.79 5.94,-15.45 3.21,-6.9 4.69,-8.61 8.03,-15.52 1.57,-4.79 4.04,-10.65 1.21,-15.31 0.59,-15.29 3.21,-15.37 3.92,-13.88 0.46,-1.55 7.46,-15.52 6.43,-12.46 1.64,-3.08 6.5,-15.5 5.11,-15.46 0.91,-2.36 4.5,-13.11 6.45,-15.51 3.25,-7.75 4.08,-7.78 6.43,-15.52 3.8,-10.68 3.8,-4.87 8.93,-15.59 1.85,-4.72 4.39,-10.79 4.41,-15.47 5.49,-10.34 2.98,-5.24 9.15,-15.61 2.54,-3.07 7.72,-12.57 7.04,-8.87 15.38,0.87 15.34,-0.53 0.4,-7.86 -0.98,-13.85 -0.59,-1.47 -3.78,-15.27 -1.92,-15.31 -2.74,-15.31 -0.98,-15.36 5.48,-15.53 2.36,-3.71 5.43,-11.88 9.29,-14.29 0.72,-1.37 10.05,-15.66 4.04,-6.16 4.52,-9.46 10.27,-15.51 0.15,-0.16 14.91,-14.21 2.62,-1.63 12.58,-7.48 12.24,-8.53 2.93,-2.27 10.12,-13.46 4.8,-8.11 3.57,-7.51 9.23,-15.64 2.03,-3.33 7.26,-12.32 1.38,-15.47 -9.52,-11.2 -6.25,-3.9 -9.44,-6.53 -15.34,4.99 -6.47,2.26 -8.87,2.63 -15.47,-0.74 -0.62,-1.31 0.48,-4.72 2.07,-10.8 11.46,-15.73 1.29,-0.89 15.32,-6.42 9.97,-8.76 5.2,-4.34 15.22,-10.85 0.56,-0.75 14.63,-12.48 3.43,-3.39 11.68,-13.44 2.3,-2.33 12.69,-15.75 0.11,-0.29 0.19,0.28 15.43,6.57 9.99,8.39 5.72,2.72 5.54,-2.95 4.31,-15.56 4.97,-14.41 0.18,-1.18 3.22,-15.55 -2.01,-15.46 -2.17,-7.35 -14.06,-7.83 -1.61,-0.85 -10.49,-14.41 1.36,-15.54 7.1,-15.66 1.1,-1.53 15.29,-11.55 8.26,-2.92 7.18,-1.57 10.11,1.25 5.46,1.37 14.91,13.77 -5.28,15.61 -8.95,6.7 -8.91,9.14 9.13,2.9 15.64,7.3 3.53,4.77 12.2,7.67 5.89,7.5 9.89,8.58 6.34,6.62 9.47,11.74 3.26,3.51 10.86,15.29 1.75,3.35 6.55,11.98 8.48,15.32 0.93,1.48 8.8,13.81 6.17,15.35 1.05,3.81 5.69,11.52 10.09,8.54 15.39,-2.87 8.28,-6.22 6.96,-6.26 6.32,-9.4 8.82,-10.28 4,-5.36 7.48,-15.57 3.54,-7.75 2.21,-7.8 2.17,-15.5 2.07,-15.5 1.36,-15.49 0.04,-15.48 1.08,-15.5 0.28,-15.5 -2.65,-15.46 -5.63,-15.42 -2.94,-4.58 -8.3,-10.76 -7.53,-11.26 -3.05,-4.1 -6.62,-15.42 -5.73,-15.44 3.59,-15.59 4.72,-15.6 4.08,-15.602 1.77,-2.344 15.38,-11.215 4.49,-2.297 10.93,-6.977 10.91,-8.875 3.64,-15.605 -2.02,-15.531 2.4,-5.824 15.45,-8.321 15.56,-0.336 15.58,0.535 15.56,-0.113 7.84,-2.422 7.63,-5.152 12.67,-10.652 2.77,-0.59 15.54,-2.504 15.55,-1.902 15.51,-5.11 15.53,-4.539 8.06,-1.699 7.47,-2.063 15.55,-2.187 15.55,-2.11 15.57,-0.164 15.57,-0.117 13.26,-9.672 2.22,-2.004 10.23,-13.671 -10.34,0.082 -15.58,0.125 -2.48,0.023 -13,11.063 -15.59,-1.079 -15.57,0.844 -15.57,0.317 -15.61,-3.649 -15.65,-6.367 -0.51,-0.277 -15.07,0.156 -15.58,0.168 -15.58,0.172 -15.59,0.179 -15.58,0.184 -15.58,0.187 -15.58,0.196 -15.59,0.199 -15.58,0.203 -15.59,0.207 -15.58,0.215 -15.59,0.219 -15.58,0.226 -15.59,0.227 -15.59,0.234 -4.6,0.074 -10.8,12.012 -5.59,3.828 -9.86,5.321 -15.48,6.293 -8.58,4.519 -6.84,5.578 -5.71,10.211 5.98,5.641 15.65,4.637 6.47,4.835 5.64,15.481 1.03,15.547 3.12,6.558 2.38,8.914 1.97,15.524 2.99,15.5 7.72,15.416 1.41,2.18 6.75,13.23 -6.38,9.84 -10.51,5.97 -4.88,2.7 -15.48,3.16 -10.26,-5.35 -5.42,-3.31 -11.88,-11.93 -1.32,-15.52 -2.95,-8.24 -3.11,-7.205 -12.74,-9.91 -7.05,-5.297 -8.76,-9.183 -7.44,-6.082 -8.36,-6.871 -13.88,-8.289 -1.84,-0.348 -15.57,-0.063 -3.74,0.805 -11.65,8.891 -5.34,7 -9.93,8.09 -11,7.882 -4.3,5.5 -7.96,10.305 -7.24,7.365 -8.09,8.5 -7.13,8.08 -5.52,7.74 -9.62,11.91 -3.56,3.91 -11.7,9.52 -10.09,6.49 -5.22,3.88 -14.16,12.09 -1.07,1.86 -8.85,13.9 -6.15,10.09 -4.25,5.67 -10.79,15.62 -0.13,0.16 -11.14,15.78 -3.73,6.18 -6.24,9.58 -7.36,15.69 -1.25,2.69 -5.78,12.99 -7.52,15.68 -1.42,3.98 -3.61,11.65 -3.31,15.58 -4.87,15.61 -2.47,6.67 -2.52,8.94 -2.15,15.53 -3.06,15.56 -6.37,14.06 -0.94,1.59 -6.5,15.64 -7.2,14.62 -1.37,1.07 -11.67,15.76 -1.82,5.79 -6.77,9.9 -5.62,15.6 -2.3,2.76 -4.17,-2.59 -6.77,-15.26 -5.06,-2.28 -1.49,2.46 -13.47,15.21 -0.26,0.62 0.43,15.43 0.61,15.43 0.16,1.95 1.31,13.44 -0.87,2.21 -1.94,13.3 1.18,15.39 0.72,15.4 -2.96,15.5 -2.27,15.48 -3.44,15.5 -3.82,10.14 -1.52,5.42 -6.84,15.59 -6.04,12.75 -0.76,2.84 -1.76,15.44 -0.38,15.39 1.77,15.32 2.02,15.31 1.43,13.25 0.25,2.06 0.11,9.81 0.06,5.54 -1.55,15.4 -3.43,15.45 -4.67,15.49 -1.31,15.38 -0.41,15.34 -1.44,1.74 -6.73,13.84 -3.08,15.42 1.5,15.27 -1.75,15.36 -2.99,11.83 -0.74,3.6 -1.9,15.36 -2.9,15.39 -5.32,15.46 -2.53,8.54 -1.73,6.88 -1.27,15.32 0.07,15.27 0.15,15.27 -3.79,15.38 -5.93,14.79 -0.25,0.68 -5.14,15.43 -4.15,15.39 -4.13,14.56 -0.29,0.83 -4.74,15.4 -2.75,15.33 -2.65,15.32 -2.97,5.33 -9.31,10.33 -5.35,5.36 -5.97,10.26 -1.4,15.26 4.42,15.05 4.82,11.07 1.57,3.89 5.21,15.01 5.91,14.97 4.01,7.67 4.01,7.21 7.93,14.89 4.38,9.51 2.69,5.4 7.63,14.88 1.84,15.08 1.93,15.08 3.08,4.85 6.52,9.93 9.28,8.62 5.9,5.97 -2.26,15.2 -2.4,12.94 -0.42,2.28 0.53,0.83 9.4,13.92 6.5,7.78 15.06,-1.15 14.88,-6.28 4.66,-1.82 9.87,-14.34 3.11,13.88 0.78,15.07 2.38,15 2.22,15.01 0.05,15.07 -0.75,15.1 -1.62,15.12 -1.31,15.1 -0.57,1.75 -11.04,13.73 -3.24,7.43 -4.87,-7.14 -8.6,-14.74 -2.51,-3.32 -8.93,-11.32 -6.85,-8.01 -15.05,0.52 -6.43,8.55 -7.94,10.11 -2.99,5.37 -1.09,15.11 -1.65,15.12 -3.41,15.18 -1.63,15.11 -1.46,7.28 -1.21,7.87 0.01,15.03 2.25,3.71 7.65,10.93 8.34,13.66 0.83,1 7.64,14.71 4.35,14.84 1.7,14.93 -0.3,15 2.6,14.88 1.19,1.03 15.38,10.19 13.03,2.59 2.06,0.37 1,-0.49 8.89,-15.31 4.29,-4.74 14.87,-2.71 3.46,6.58 3.55,14.83 8.99,6.11 5.51,8.3 10.08,8.68 4.62,5.72 10.88,9.26 6.87,5.02 8.7,12.27 2.64,2.24 11.69,14.5 1.33,3.33 3.61,-3.51 10.9,-7.66 4.44,-7.82 9.8,-11.45 6.86,-4.06 7.5,-12 3.48,-3.31 4.99,-15.1 5.46,-10.7 1.23,-4.47 13.05,-15.19 0.12,-0.19 14.42,-12.04 5.01,-3.55 9.71,-3.57 14.9,-1.37 14.83,-3.88 11.69,-7.75 -3.61,-14.84 -8.46,-14.7 13.98,-6.58 13.06,5.76 2.2,4.19 7.67,10.47 7.68,2.65 14.86,-2.97 0.43,-0.36 14.15,-12.45 2.02,-2.97 7.29,-15.16 4.93,-7.1 8.64,-8.24 5.93,-5.92 14.74,-8.1 7.89,-1.72 7,-1.49 14.83,-4.9 15.09,4.68 3.51,0.65 6.3,14.8 -9.18,9.05 -8.45,6.36 -6.28,2.2 -14.82,5.01 -10.35,8.57 -4.18,6.71 -3.29,8.44 -2.63,15.01 -1.14,14.96 -1.8,14.97 -3.61,15.02 3.09,14.82 2.52,14.84 9.91,11.88 3.76,2.62 11.31,4.04 14.96,2.67 14.87,-0.59 14.9,0.95 14.89,0.53 14.75,-5.2 10.39,-4.94 4.32,-1.58 14.86,-0.63 14.07,1.39 0.85,0.3 0.91,-0.34 13.9,-2.12 13.23,-13.38 1.19,-6.45 6.52,-8.61 8.1,-3.33 2.73,3.09 12.43,9.78 14.78,-4.72 14.84,-1.36 14.9,0.98 14.91,2.17 14.84,-1.66 11.1,-7.19 3.62,-1.02 14.76,-6.33 12.06,-8.08 2.62,-2.97 14.71,-9.44 4.65,-2.85 10.11,-4.57 14.73,-9.91 0.91,-0.83 13.83,-8.12 7.8,-7.1 6.89,-6.6 11.89,-8.58 2.82,-4.06 14.81,-6.85 14.86,-3.32 6.12,-1.2 8.74,-1.86 14.9,-0.41 2.73,1.93 12.27,5.67 14.93,2.77 14.88,-0.63 14.88,-2.36 14.86,-3.26 14.88,-1.43 14.93,2.78 14.96,8.13 3.89,1.99 11.06,5.51 14.94,7.42 2.14,1.73 12.81,8.47 13.71,6.22 1.22,1.01 9.13,13.79 5.86,6.22 14.9,7.72 2.12,0.79 12.78,7 11.25,7.73 3.65,2.01 14.89,12.69 0.08,0.06 14.8,11.18 8.26,3.57 6.6,3.14 14.83,-1.14 4.43,-2.07 10.37,-11.97 12.44,-2.92 -2.29,-14.83 2.28,-14.86 2.35,-7.22 1.94,-7.64 12.9,-6.5 14.86,-7.57 9.78,14.04 3.65,14.85 -2.9,14.85 -10.5,12.4 -10.8,-12.38 -4.07,-11.36 -7.45,11.37 -7.08,14.85 -0.28,1.62 -4.06,13.22 4.09,2.73 14.83,0.83 14.83,0.19 8.75,11.04 6.08,3.14 14.82,-0.75 14.81,10.47 4.14,1.98 10.67,4.6 14.8,7.35 14.81,-1.78 12.52,-10.06 2.33,-0.61 2.11,0.62 12.69,4.35 13,10.56 1.76,1.42 13.7,13.46 1.05,0.68 14.76,7.86 14.79,0.78 14.79,1.7 14.77,4.02 0.15,0.1 14.56,12.19 5.69,2.75 9.04,4.25 m 225.1,-208.36 -2.28,-1.16 2.32,-1.71 0.57,1.75 -0.61,1.12 m 16.48,-104.34 -1.66,-1.1 -13.1,-12.89 -1.9,-2.29 1.97,-2.58 14.99,-1.51 14.9,4.29 0.16,0.27 -0.17,0.16 -13.86,14.6 -1.33,1.05 m 89.69,4.2 -4.51,-3.9 4.65,-3.93 7.87,4.16 -8.01,3.67 m 328.17,51.32 -3.92,-2.81 -10.76,-7.96 -6.47,-7.5 6.48,-14.81 0.63,-1.08 6.55,-13.72 9.18,-12.57 14.88,4.55 5.62,8.85 1.91,15.06 -0.91,14.96 -8.01,9.83 -10.03,4.64 -5.15,2.56 m 90.79,-28.6 -1.66,-1.47 -7.86,-15.25 -0.73,-15.03 -3.41,-12.91 -14.95,-2.47 -0.18,-0.19 -5.8,-15.2 -3.38,-15.12 3.22,-14.95 7.66,-6.59 15.02,0.84 15.08,-8.19 0.21,-0.14 0.1,0.15 2.06,15.11 4.2,15.17 7.51,8.73 0.21,6.54 3.94,15.15 6.67,15.24 2.86,6.48 4.66,8.77 -5.16,7.45 -8.45,7.14 -7.22,13.96 -14.6,-13.22 m 29.42,18.99 -9.49,-4.78 9.67,-0.87 0.67,1.19 -0.85,4.46 m 28.92,-1036.08 -5.58,-2.35 -9.51,-10.89 -2.24,-4.82 2.49,-5.57 2.8,-9.72 -2.27,-12.39 -1.13,-3.12 1.23,-0.78 15.5,-2.76 9.85,4.19 5.43,1.69 14.9,14.25 -2.18,15.37 -13.82,14.32 -4.78,0.63 -10.69,1.95 m 4.52,414.79 -1.25,-2.79 1.39,-2.31 2.13,2.41 -2.27,2.69 m 27.89,-477.58 -0.36,-0.33 0.39,-1.01 15.65,-8.02 13.45,9.78 -13.86,6.22 -15.27,-6.64 m 453.72,-154.37 -2.54,-2.98 -12.38,-15.37 -0.78,-0.62 -14.63,-3.56 -15.54,0.03 -14.71,2.05 -0.9,0.19 -0.36,-0.23 -15.03,-4.45 -15.42,-3.77 -15.37,-5.25 -9.24,-3.82 -5.92,-8.12 -3.38,-7.71 -1.94,-15.61 -9.03,-15.64 -0.2,-0.19 -8.77,-15.82 9.9,-14.43 2.32,-0.75 -2.29,-0.4 -15.46,-3.43 -15.35,-6.78 -11.68,-6.29 12.27,-13.96 4.59,-1.11 11.11,-3.3 2.98,-11.85 4.88,-15.43 8.65,-4.03 15.5,2.88 10.66,2.2 4.83,0.78 15.55,1.21 15.6,-0.52 3.55,-0.25 12.06,-0.41 15.6,-0.25 15.67,-2.51 15.57,0.82 11.83,4.61 3.57,1.33 15.32,8.2 9.88,7.02 5.39,2.59 15.27,9.59 5.21,4.28 9.96,8.01 15.33,7.41 2.19,1.12 13.15,6.02 15.25,9.57 1.23,1.04 13.96,10.09 9.79,6.34 5.44,3.6 15.27,8.8 7.78,4.23 7.5,3.91 15.28,8.38 5.76,4.35 9.38,7.24 9.57,9.05 5.44,6.12 7.35,9.95 -8.05,8.36 -15.8,5.91 -0.5,0.38 -15.53,11.89 -15.31,-6.64 -13.28,-6.91 -1.99,-0.96 -3.19,0.77 -12.6,5.25 -15.69,3.6 -12.03,5.23 -3.8,2.35 -15.93,10.67 -15.59,1.11 -15.47,-2.14 -15.54,0.16 -15.39,-4.32 -15.46,-2.44 -15.32,-6.44 m 341.22,27.83 -6.34,-2.63 -9.01,-2.86 -15.44,-3.4 -15.41,-4.09 -15.42,-3.9 -7.37,-3.85 -7.8,-6.29 -6.93,-9.86 4.87,-15.39 3.14,-2.35 15.71,-3.2 15.79,-5 15.54,1.25 15.27,7.88 4.47,4.2 10.47,11.85 3.79,4.32 8.46,15.93 -8.57,15.23 -5.22,2.16 m -1873.24,-380.087 -0.94,-2.426 -6.58,-15.562 7.51,-1.547 1.46,1.543 -0.08,15.566 -1.37,2.426 m -15.18,542.507 -3.53,-3.5 -8.92,-15.37 12.43,-5.72 5.65,5.71 0.31,15.37 -5.94,3.51 m 463.22,-197 -6.76,-4.73 -8.52,-13.26 -2.24,-2.3 -13.1,-10.69 -5.71,-4.95 -9.57,-15.39 -0.59,-0.16 0.59,-0.08 15.53,-6.99 15.5,-2.33 15.42,4.87 4.32,5.01 6.11,15.53 4.77,5.61 3.7,9.94 0.74,15.46 -4.76,5.94 -15.43,-1.48 m 143.05,-309.839 -5.3,-3.469 2.48,-15.535 3.09,-3.293 15.65,-6.141 15.56,1.43 15.47,7.355 1.99,1.313 6.78,15.66 -9,0.914 -15.58,0.668 -15.56,-0.058 -15.58,1.156 m 334.95,375.289 -0.92,-0.88 -14.38,-6.49 -15.44,-0.85 -15.5,2 -15.47,0.59 -15.42,-1.69 -15.46,0.3 -15.37,-4.31 -15.48,1.64 -15.37,-4.47 -4.68,-4.95 -10.54,-8.25 -15.45,-0.5 -15.51,3.33 -15.36,-5.28 -10.67,-5.9 -4.66,-1.91 -15.3,-9.32 -13.55,-4.75 -1.81,-1.55 -10.95,-14.11 -2.66,-15.5 14.24,-12.15 15.51,-1.89 1.13,-0.96 1.48,-15.46 7.46,-15.37 6.03,-7.74 15.55,-3.82 12.54,12.11 2.74,0.83 15.31,10.27 15.41,4.61 2.09,0.38 9.88,15.65 2.61,15.53 0.34,0.35 15.32,8.71 15.35,6.81 0.34,0.17 15.07,3.07 15.43,2 15.54,-3.36 0.63,-0.83 -0.54,-3.76 -4.95,-11.82 5.26,-4.14 15.56,-3.88 15.48,0.08 15.5,-0.83 15.51,-0.96 15.44,-4.08 0.14,-0.06 15.67,-8.19 15.6,-5.21 15.46,1.82 15.44,2.88 15.52,-1.11 15.54,-1.58 15.52,-0.91 4.34,-0.62 11.3,-4.9 10.14,-10.1 5.67,-2.74 15.7,-7.47 7.36,-4.61 8.39,-4.72 15.59,-2.71 15.51,0.49 15.56,-1.28 4.42,-5.81 -4.11,-6.32 -7.92,-9.52 8.1,-15.33 0.45,-0.17 2.25,0.24 13.26,1.14 15.51,1.18 15.53,0.43 15.47,2.64 15.32,8.46 11.28,3.97 4.13,0.9 15.45,3.01 15.37,6.39 9.63,6.49 5.65,2.8 15.28,8.97 5.93,4.54 9.29,6.38 8.52,9.68 6.42,10.44 6.02,5.46 -6.49,10.28 -2.96,4.96 -12.91,6.8 -15.35,-5.85 -15.6,2.69 -15.39,-4.55 -15.79,9.53 -3.49,4.62 -12.33,6.37 -15.55,1.36 -15.56,1.97 -15.48,-0.61 -15.54,1.24 -3.49,3.04 -12.27,6.65 -15.52,0.87 -15.49,0.01 -15.5,0.4 -15.54,1.7 -11.87,3.65 -3.75,1.89 -15.72,9.69 -6,3.28 -9.66,4.04 -15.56,3.4 -15.33,-6.02 -15.53,2.17 -15.63,6.93 -6.58,3.11 -9.06,4.75 -15.55,3.41 -15.56,4.55 -9.32,1.66 -6.23,2.72 -15.41,-2.33 m -121.48,-117.72 -10.68,-9.49 11.09,-13.62 15.47,1.6 14.19,12.76 -14.62,10.79 -15.45,-2.04 m 127.54,-177.081 -6.7,-0.711 -8.73,-6.176 -2.99,-9.613 1.5,-15.535 2.12,-6.77 4.51,6.899 10.75,8.547 3.47,7.3 -2.79,15.504 -1.14,0.555 m 17.11,-77.285 -1.62,-0.836 1.66,-1.156 15.56,1.375 0.09,0.129 -0.1,0.027 -15.59,0.461 m 262.04,118.576 -12.39,-4.65 -3.02,-1.08 -15.43,-5.52 -15.43,-5.61 -15.53,-1.63 -15.61,1.85 -8.59,-5.41 8.97,-10.16 4.49,-5.09 -4.21,-6.448 -6.29,-9.375 -8.75,-13.176 -1.33,-2.644 1.68,-12.133 0.53,-3.399 15.31,-7.066 15.74,-6 7.54,-1.594 8.14,-2.109 7.15,2.484 8.34,1.895 15.45,5.75 14.5,8.914 0.85,0.664 15.32,10.465 5.76,5.027 9.5,7.801 7.66,8.242 7.51,7.305 13.46,8.847 1.85,1.47 8.21,14.38 -8.74,5.01 -15.59,0.37 -15.64,2.36 -15.72,5.95 -0.95,0.36 -14.74,3.95 m -198.48,506.72 -8.5,-5.62 8.74,-4.13 5.44,4.48 -5.68,5.27 m -744.07,1000.58 -2.45,-4.21 2.57,-9.92 0.66,-4.96 9.5,-14.82 4.97,-6.33 14.89,3.52 3.16,3.01 4.19,14.95 -7.59,7.06 -14.34,7.64 -0.63,0.7 -14.93,3.36 m -1388.38,-985.84 -0.37,-1.15 0.24,-3.27 4.6,-12.25 10.24,-7.76 6.38,7.3 -2.2,15.45 -3.36,6.94 -15.53,-5.26 m 439.15,-386.23 -14.64,-10.07 -1.03,-1.09 -6.38,-14.28 -9.48,-8.7 -3.83,-6.58 -7.03,-15.39 -2.31,-15.47 12.39,-9.98 15.56,2.92 11.81,6.42 3.87,4.27 13.67,10.97 2.04,2.28 4.8,13.11 -0.81,15.51 -3.3,15.53 -0.01,0.05 -15.32,10.5"
    //val c="3456 789 2365 1234"
    //val c="m 3983.57,3120.01 0.01,-0.03 -2.17,-10.46 -7.63,0.13 -3.93,-8.98 -11.75,0.16 2.45,12.46 8.59,7.54 -0.99,17.93 10.76,25.37 -6.53,-9.81 -5.16,-0.02 0.15,-4.35 -2.84,5.44 -7.56,-7.2 -2.85,3.64 0.49,-6.63 2.68,1.38 3.94,-7.14 -3.36,-7.59 -3.77,-0.56 -1.76,9.53 -2.33,-10.64 -2.29,7.08 0.94,-7.52 -3.95,-3.55 1.68,11.79 -8.93,-14.49 -3.09,1.77 13.38,19.81 -5.85,-8.44 -3.74,0.66 1.89,11.5 -2.11,-3 0.38,8.11 -2.54,-3.09 -2.39,4.84 3.72,-9.89 -4.3,-8.85 -3.85,0.04 1.79,5.81 -1.56,-4.7 -5.63,4.99 7.32,-11.81 -4.72,-3.46 -5.33,7.89 5.02,-8.16 -6.06,-4.52 -3.34,5.11 2.89,-5.32 -7.42,-1.6 3.24,-3.5 -5.31,1.66 4.6,-2.67 -2.11,-3.9 -2.13,2.88 0.68,-4.06 -3.73,5.05 3,-4.89 -10.5,-3.6 -5.18,5.26 2.67,-4.18 -4.69,-4.56 -3.4,10.4 1.6,-7.72 -9.38,-8.67 -4.18,1.95 -6.08,-4.22 -0.49,4.41 -2.75,-5.43 -3.29,3.35 0.2,-4.53 -8.99,-6.74 0.3,8.08 -2.87,-0.15 0.78,-9.69 -6.47,2.17 0.07,-7.54 -0.76,3.65 -1.08,-5.58 -15.32,-11.18 -6.61,0.17 -5.07,12.06 -6.31,0.08 12.52,42.79 8.38,10.83 -16.62,-6.67 -15.78,-14.91 7.63,26.19 -2.2,-12.06 4.72,-2.2 -0.94,5.73 6.8,-2.09 -6.2,34.89 3.59,-3.02 6.62,4.28 5.77,-2.78 6.33,2.59 -6.7,-1.55 -6.85,4.84 8.3,8.74 -7.92,-6.17 3.27,7.78 -9.12,-5.79 -5.35,7.74 3.37,13.37 6.52,-4.47 -0.94,4.5 6.76,0.02 -7.23,2.6 -0.89,-2.68 -7.24,6.69 -0.77,12.01 6.51,0.9 -8.3,1.43 1.92,8.33 -7.57,35.01 6.34,5.14 -10.48,-0.72 8.33,17.65 -0.53,3.27 -7.57,0.76 6.3,3.73 -3.64,0.21 3.45,7.85 -3.46,11.01 16.26,30.98 4.15,-6.49 7.66,3.08 -5.49,4.53 9.93,5.87 -0.76,-6.44 5.2,-5.51 -3.18,-1.14 2.02,-4.65 -16.9,-6.13 7.8,-8.17 6.43,7.03 5.18,-5.45 -0.01,-25.74 -7.66,6.34 9.22,-11.28 -3.97,-9.91 3.47,0.41 -0.43,-8.95 -4.3,-0.04 4.88,-2.58 0.61,-13.74 -4.58,-2.38 4.31,0.89 -1.47,-6.67 5.61,-9.95 -2.54,-6.74 6.17,-0.1 1.96,-9.58 0.05,18.85 3.14,2.29 -2.95,-0.11 5.06,6.25 -1.09,17.55 5.23,-2.43 0.31,-10.08 2.36,9.29 1.38,-3.41 1.67,5.3 8.72,-2.98 5.01,9.26 3.12,-0.67 -13.14,-26.82 3.44,1.52 -0.95,-8.56 2.85,7.78 4.48,4.75 -0.66,-8.31 3.95,4.76 -4.76,-15.26 6.5,10.95 5.28,-0.26 -1.27,-3.47 3.5,4.27 2.27,-4.82 1.14,8.47 2.96,-7.52 1.04,11.08 1.05,-5.36 3.05,4.1 -1.2,-7.72 1.19,2.93 1.88,-3.1 -0.08,6.09 3.09,-5.4 -0.75,6.51 -7,4.67 5.18,0.48 0.36,3.67 8.19,-29.82 3.86,8.28 -2.01,-3.39 -3.83,4.15 4.84,8.69 -3.35,4.25 6.12,-6.08 2.77,6.91 -2.79,6.86 5.14,-6.77 2.07,22.22 1.84,-8.93 1.89,5.17 5.72,-12.12 -2.01,11.62 7.78,0.46 0.68,8.01 24.5,2.26 3,-7.59 -2.97,-3.02 4.91,-3.7 -8.72,-5.57 5.88,1.17 -5.52,-4.16 4.82,-0.81 -7.58,-18.12 9.35,12.65 -0.55,-12 1.89,3.77 0.81,-2.37 0.89,6.67 0.7,-3.59 9.56,3.08 -7.82,-10.4 0.78,-2.54 7.11,6.75 -9.75,-19.14 3.08,-1.47 6.01,13.9 2.82,-5.73 0.98,12.79 0.78,-8.11 1.04,8.85 3.08,-8.32 -1.34,16.03 9.56,-0.95 -0.35,12.67 7.86,-5.84 -0.02,-13.91 -6.78,-1.73 3.32,-6.16 -5.03,-10.39 -12.39,-4.05 5.96,-6.99 9.14,4.8 -8.15,-7.92 10.36,8.98 3.17,-17.7 -7.57,0.76 12.36,-7.19 1.71,4.68 5.74,-8.21 0.12,3.33 3.7,-0.73 -7.67,29.3 6.27,7.43 0.79,9.32 4.76,-1.89 -2.22,-13.1 4.25,-20.91 3.6,2.63 -1.54,-5.25 2.35,3.35 2.52,-6.45 0.07,3.77 5.41,-5.11 1.67,12.27 -4.68,15.87 15.15,-10.01 5.95,-26.32 -2.59,-2.13 4.2,1.09 -1.49,-5.54 3.25,0.14 4.28,-10.65 -1.65,-12.59 -7.85,3.06 -2.38,-5.49 -0.9,4.91 -0.92,-11.36 -4.05,-0.83 -7.28,8.24 -0.1,10.84 -2.23,-4.31 -2.9,1.53 1.84,14.02 -2.86,-4.99 -2.98,4.58 -1.59,-27.22 -1.5,-5.29 -5.66,-1.4 -7.41,24.49 2.24,3.55 -4.42,0.63 4.27,1.9 -3.88,3.03 2.74,5.8 -3.82,-3.68 -5.15,9.52 -14.98,9.41 1.45,-3.35 -6.26,0.5 7.95,-26.87 -4.08,-7.36 -1.2,16.97 -0.19,-15.99 -5.92,-5.52 -2.45,3.16 2.03,-17.48 -4.16,-0.78 5.37,-4.35 -1.1,-5.73 -3.82,3.62 3.21,-4.55"
    //val c="2"*50
    //val c="M -3 3  L 3 3  L 3 -3  L -3 -3  z"
    parse(svg_path, c) match {
      case Success(matched,_) => println(s"[matched]: ${matched}")
      case Failure(msg,_) => println("FAILURE: " + msg)
      case Error(msg,_) => println("ERROR: " + msg)
    }
    println(SVGPathfromDString.getPathCommands(c))
  }
}
